{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { store } from 'react-notifications-component';\n\nfunction UserAPI(token) {\n  const [isLogged, setIsLogged] = useState(false);\n  const [isAdmin, setIsAdmin] = useState(false);\n  const [cart, setCart] = useState([]);\n  const [history, setHistory] = useState([]);\n  const [wishlist, setWishlist] = useState([]);\n  useEffect(() => {\n    if (token) {\n      const getUser = async () => {\n        try {\n          const res = await axios.get('/user/infor', {\n            headers: {\n              Authorization: token\n            }\n          });\n          setIsLogged(true);\n          res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false);\n          setCart(res.data.cart);\n        } catch (err) {\n          alert(err.response.data.msg);\n        }\n      };\n\n      getUser();\n    }\n  }, [token]);\n\n  const addCart = async product => {\n    if (!isLogged) {\n      store.addNotification({\n        title: \"Please Login!!\",\n        message: \"Please login to add your cart!\",\n        type: \"danger\",\n        insert: \"top\",\n        container: \"top-center\",\n        animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n        animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n        dismiss: {\n          duration: 2500,\n          onScreen: true\n        }\n      });\n    } else {\n      const check = cart.every(item => {\n        return item._id !== product._id;\n      });\n\n      if (check) {\n        setCart([...cart, { ...product,\n          quantity: 1\n        }]);\n        await axios.patch('/user/addcart', {\n          cart: [...cart, { ...product,\n            quantity: 1\n          }]\n        }, {\n          headers: {\n            Authorization: token\n          }\n        });\n        store.addNotification({\n          title: \"SuccessFul added to cart!\",\n          message: \"Please check your cart!\",\n          type: \"success\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n          animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n          dismiss: {\n            duration: 2500,\n            onScreen: true\n          }\n        });\n      } else {\n        store.addNotification({\n          title: \"This product just in your cart!\",\n          message: \"Please check your cart!\",\n          type: \"warning\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n          animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n          dismiss: {\n            duration: 2500,\n            onScreen: true\n          }\n        });\n      }\n    }\n  };\n\n  const addWishList = async product => {\n    if (!isLogged) {\n      store.addNotification({\n        title: \"Please Login!!\",\n        message: \"Login to like this!\",\n        type: \"danger\",\n        insert: \"top\",\n        container: \"top-center\",\n        animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n        animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n        dismiss: {\n          duration: 2500,\n          onScreen: true\n        }\n      });\n    } else {\n      const check = wishlist.every(item => {\n        return item._id !== product._id;\n      });\n\n      if (check) {\n        setWishlist([...wishlist, { ...product,\n          quantity: 1\n        }]);\n        await axios.patch('/user/addwishlist', {\n          wishlist: [...wishlist, { ...product,\n            quantity: 1\n          }]\n        }, {\n          headers: {\n            Authorization: token\n          }\n        });\n        store.addNotification({\n          title: \"You like it!\",\n          message: \"This product is in your wishlist!\",\n          type: \"success\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n          animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n          dismiss: {\n            duration: 2500,\n            onScreen: true\n          }\n        });\n      } else {\n        store.addNotification({\n          title: \"This product just in your wishlist!\",\n          message: \"Please check its!\",\n          type: \"warning\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n          animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n          dismiss: {\n            duration: 2500,\n            onScreen: true\n          }\n        });\n      }\n    }\n  };\n\n  return {\n    isLogged: [isLogged, setIsLogged],\n    isAdmin: [isAdmin, setIsAdmin],\n    cart: [cart, setCart],\n    wishlist: [wishlist, setWishlist],\n    addWishList: addWishList,\n    addCart: addCart,\n    history: [history, setHistory]\n  };\n}\n\nexport default UserAPI;","map":{"version":3,"sources":["/home/phuocnghia712/PBL6_Toystore/client/src/api/UserAPI.js"],"names":["useState","useEffect","axios","store","UserAPI","token","isLogged","setIsLogged","isAdmin","setIsAdmin","cart","setCart","history","setHistory","wishlist","setWishlist","getUser","res","get","headers","Authorization","data","role","err","alert","response","msg","addCart","product","addNotification","title","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","check","every","item","_id","quantity","patch","addWishList"],"mappings":"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","sourcesContent":["import {useState, useEffect} from 'react'\nimport axios from 'axios'\nimport { store } from 'react-notifications-component';\n\nfunction UserAPI(token) {\n    const [isLogged, setIsLogged] = useState(false)\n    const [isAdmin, setIsAdmin] = useState(false)\n    const [cart, setCart] = useState([])\n    const [history, setHistory] = useState([])\n    const [wishlist,setWishlist] = useState([])\n    useEffect(() =>{\n        if(token){\n            const getUser = async () =>{\n                try {\n                    const res = await axios.get('/user/infor', {\n                        headers: {Authorization: token}\n                    })\n\n                    setIsLogged(true)\n                    res.data.role === 1 ? setIsAdmin(true) : setIsAdmin(false)\n\n                    setCart(res.data.cart)\n\n                } catch (err) {\n                    alert(err.response.data.msg)\n                }\n            }\n\n            getUser()\n            \n        }\n    },[token])\n\n    \n\n    const addCart = async (product) => {\n        if(!isLogged) {\n            store.addNotification({\n                title: \"Please Login!!\",\n                message: \"Please login to add your cart!\",\n                type: \"danger\",\n                insert: \"top\",\n                container: \"top-center\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                },\n                \n              });\n        }\n        else{\n\n        \n\n        const check = cart.every(item =>{\n            return item._id !== product._id\n        })\n\n        if(check){\n            setCart([...cart, {...product, quantity: 1}])\n\n            await axios.patch('/user/addcart', {cart: [...cart, {...product, quantity: 1}]}, {\n                headers: {Authorization: token}\n            })\n\n            store.addNotification({\n                title: \"SuccessFul added to cart!\",\n                message: \"Please check your cart!\",\n                type: \"success\",\n                insert: \"top\",\n                container: \"top-right\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                }\n              });\n\n        }else{\n            store.addNotification({\n                title: \"This product just in your cart!\",\n                message: \"Please check your cart!\",\n                type: \"warning\",\n                insert: \"top\",\n                container: \"top-right\",\n                animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n                animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n                dismiss: {\n                  duration: 2500,\n                  onScreen: true\n                },\n                \n              });\n        }\n    }\n}\nconst addWishList = async (product) =>{\n    if(!isLogged) \n     {\n    store.addNotification({\n        title: \"Please Login!!\",\n        message: \"Login to like this!\",\n        type: \"danger\",\n        insert: \"top\",\n        container: \"top-center\",\n        animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n        animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n        dismiss: {\n          duration: 2500,\n          onScreen: true\n        },\n        \n      });}\n    else{\n    const check = wishlist.every(item =>{\n        return item._id !== product._id\n    })\n\n    if(check){\n        setWishlist([...wishlist, {...product, quantity: 1}])\n\n        await axios.patch('/user/addwishlist', {wishlist: [...wishlist, {...product, quantity: 1}]}, {\n            headers: {Authorization: token}\n        })\n\n\n        store.addNotification({\n            title: \"You like it!\",\n            message: \"This product is in your wishlist!\",\n            type: \"success\",\n            insert: \"top\",\n            container: \"top-right\",\n            animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n            animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n            dismiss: {\n              duration: 2500,\n              onScreen: true\n            }\n          });\n       \n\n    }else{\n        store.addNotification({\n            title: \"This product just in your wishlist!\",\n            message: \"Please check its!\",\n            type: \"warning\",\n            insert: \"top\",\n            container: \"top-right\",\n            animationIn: [\"animate__animated\", \"animate__fadeIn\"],\n            animationOut: [\"animate__animated\", \"animate__fadeOut\"],\n            dismiss: {\n              duration: 2500,\n              onScreen: true\n            },\n            \n          });\n    }}\n}\n\n    return {\n        isLogged: [isLogged, setIsLogged],\n        isAdmin: [isAdmin, setIsAdmin],\n        cart: [cart, setCart],\n        wishlist: [wishlist,setWishlist],\n        addWishList: addWishList,\n        addCart: addCart,\n        history: [history, setHistory]\n    }\n}\n\nexport default UserAPI\n "]},"metadata":{},"sourceType":"module"}